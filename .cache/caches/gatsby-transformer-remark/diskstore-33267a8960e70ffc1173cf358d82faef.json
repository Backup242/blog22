{"expireTime":9007200908525412000,"key":"transformer-remark-markdown-html-ast-020f8db2e64a44cf2653a211df8376f5--","val":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"ðŸ’» PSQLðŸ’»","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":12,"offset":12}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":12,"offset":12}}},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"source","position":{"start":{"line":4,"column":3,"offset":16},"end":{"line":4,"column":9,"offset":22}}}],"position":{"start":{"line":4,"column":3,"offset":16},"end":{"line":4,"column":9,"offset":22}}},{"type":"text","value":"\n"}],"position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":4,"column":9,"offset":22}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Basic Commands","position":{"start":{"line":6,"column":4,"offset":27},"end":{"line":6,"column":18,"offset":41}}}],"position":{"start":{"line":6,"column":1,"offset":24},"end":{"line":6,"column":18,"offset":41}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Login to postgresql","position":{"start":{"line":8,"column":5,"offset":47},"end":{"line":8,"column":24,"offset":66}}}],"position":{"start":{"line":8,"column":1,"offset":43},"end":{"line":8,"column":24,"offset":66}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plpgsql"]},"children":[{"type":"text","value":"psql -U postgres\npsql -d mydb -U myuser -W\npsql -h myhost -d mydb -U myuser -W\npsql -U myuser -h myhost \"dbname=mydb sslmode=require\" # ssl connection\n"}],"position":{"start":{"line":10,"column":1,"offset":68},"end":{"line":15,"column":4,"offset":233}}}],"position":{"start":{"line":10,"column":1,"offset":68},"end":{"line":15,"column":4,"offset":233}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Default Admin Login","position":{"start":{"line":17,"column":5,"offset":239},"end":{"line":17,"column":24,"offset":258}}}],"position":{"start":{"line":17,"column":1,"offset":235},"end":{"line":17,"column":24,"offset":258}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"sudo -u postgres psql -U postgres\nsudo -u postgres psql\n"}],"position":{"start":{"line":19,"column":1,"offset":260},"end":{"line":22,"column":4,"offset":325}}}],"position":{"start":{"line":19,"column":1,"offset":260},"end":{"line":22,"column":4,"offset":325}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"List databases on postgresql server","position":{"start":{"line":24,"column":5,"offset":331},"end":{"line":24,"column":40,"offset":366}}}],"position":{"start":{"line":24,"column":1,"offset":327},"end":{"line":24,"column":40,"offset":366}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Determine system tables","position":{"start":{"line":26,"column":5,"offset":372},"end":{"line":26,"column":28,"offset":395}}}],"position":{"start":{"line":26,"column":1,"offset":368},"end":{"line":26,"column":28,"offset":395}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"select * from pg_tables where tableowner = 'postgres';\n"}],"position":{"start":{"line":28,"column":1,"offset":397},"end":{"line":30,"column":4,"offset":461}}}],"position":{"start":{"line":28,"column":1,"offset":397},"end":{"line":30,"column":4,"offset":461}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"List databases from within a pg shell","position":{"start":{"line":32,"column":5,"offset":467},"end":{"line":32,"column":42,"offset":504}}}],"position":{"start":{"line":32,"column":1,"offset":463},"end":{"line":32,"column":42,"offset":504}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"List databases from UNIX command prompt","position":{"start":{"line":34,"column":5,"offset":510},"end":{"line":34,"column":44,"offset":549}}}],"position":{"start":{"line":34,"column":1,"offset":506},"end":{"line":34,"column":44,"offset":549}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Describe a table","position":{"start":{"line":36,"column":5,"offset":555},"end":{"line":36,"column":21,"offset":571}}}],"position":{"start":{"line":36,"column":1,"offset":551},"end":{"line":36,"column":21,"offset":571}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Quit psql","position":{"start":{"line":38,"column":5,"offset":577},"end":{"line":38,"column":14,"offset":586}}}],"position":{"start":{"line":38,"column":1,"offset":573},"end":{"line":38,"column":14,"offset":586}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Switch postgres database within admin login shell","position":{"start":{"line":40,"column":5,"offset":592},"end":{"line":40,"column":54,"offset":641}}}],"position":{"start":{"line":40,"column":1,"offset":588},"end":{"line":40,"column":54,"offset":641}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Reset a user password as admin","position":{"start":{"line":42,"column":5,"offset":647},"end":{"line":42,"column":35,"offset":677}}}],"position":{"start":{"line":42,"column":1,"offset":643},"end":{"line":42,"column":35,"offset":677}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"alter user usertochange with password 'new_passwd';\n"}],"position":{"start":{"line":44,"column":1,"offset":679},"end":{"line":46,"column":4,"offset":740}}}],"position":{"start":{"line":44,"column":1,"offset":679},"end":{"line":46,"column":4,"offset":740}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Show all tables","position":{"start":{"line":48,"column":5,"offset":746},"end":{"line":48,"column":20,"offset":761}}}],"position":{"start":{"line":48,"column":1,"offset":742},"end":{"line":48,"column":20,"offset":761}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"List all Schemas","position":{"start":{"line":50,"column":5,"offset":767},"end":{"line":50,"column":21,"offset":783}}}],"position":{"start":{"line":50,"column":1,"offset":763},"end":{"line":50,"column":21,"offset":783}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"List all users","position":{"start":{"line":52,"column":5,"offset":789},"end":{"line":52,"column":19,"offset":803}}}],"position":{"start":{"line":52,"column":1,"offset":785},"end":{"line":52,"column":19,"offset":803}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Load data into postgresql","position":{"start":{"line":54,"column":5,"offset":809},"end":{"line":54,"column":30,"offset":834}}}],"position":{"start":{"line":54,"column":1,"offset":805},"end":{"line":54,"column":30,"offset":834}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"psql -W -U username -H hostname < file.sql\n"}],"position":{"start":{"line":56,"column":1,"offset":836},"end":{"line":58,"column":4,"offset":888}}}],"position":{"start":{"line":56,"column":1,"offset":836},"end":{"line":58,"column":4,"offset":888}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Dump (Backup) Data into file","position":{"start":{"line":60,"column":5,"offset":894},"end":{"line":60,"column":33,"offset":922}}}],"position":{"start":{"line":60,"column":1,"offset":890},"end":{"line":60,"column":33,"offset":922}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"pg_dump -W -U username -h hostname database_name > file.sql\n"}],"position":{"start":{"line":62,"column":1,"offset":924},"end":{"line":64,"column":4,"offset":993}}}],"position":{"start":{"line":62,"column":1,"offset":924},"end":{"line":64,"column":4,"offset":993}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Increment a sequence","position":{"start":{"line":66,"column":5,"offset":999},"end":{"line":66,"column":25,"offset":1019}}}],"position":{"start":{"line":66,"column":1,"offset":995},"end":{"line":66,"column":25,"offset":1019}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"SELECT nextval('my_id_seq');\n"}],"position":{"start":{"line":68,"column":1,"offset":1021},"end":{"line":70,"column":4,"offset":1059}}}],"position":{"start":{"line":68,"column":1,"offset":1021},"end":{"line":70,"column":4,"offset":1059}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Create new user","position":{"start":{"line":72,"column":5,"offset":1065},"end":{"line":72,"column":20,"offset":1080}}}],"position":{"start":{"line":72,"column":1,"offset":1061},"end":{"line":72,"column":20,"offset":1080}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"CREATE USER lemmy WITH PASSWORD 'myPassword';\n# or\n\nsudo -u postgres createuser lemmy -W\n"}],"position":{"start":{"line":74,"column":1,"offset":1082},"end":{"line":79,"column":4,"offset":1180}}}],"position":{"start":{"line":74,"column":1,"offset":1082},"end":{"line":79,"column":4,"offset":1180}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Change user password","position":{"start":{"line":81,"column":5,"offset":1186},"end":{"line":81,"column":25,"offset":1206}}}],"position":{"start":{"line":81,"column":1,"offset":1182},"end":{"line":81,"column":25,"offset":1206}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"ALTER USER Postgres WITH PASSWORD 'mypass';\n"}],"position":{"start":{"line":83,"column":1,"offset":1208},"end":{"line":85,"column":4,"offset":1261}}}],"position":{"start":{"line":83,"column":1,"offset":1208},"end":{"line":85,"column":4,"offset":1261}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Grant user createdb privilege","position":{"start":{"line":87,"column":5,"offset":1267},"end":{"line":87,"column":34,"offset":1296}}}],"position":{"start":{"line":87,"column":1,"offset":1263},"end":{"line":87,"column":34,"offset":1296}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"ALTER USER myuser WITH createdb;\n"}],"position":{"start":{"line":89,"column":1,"offset":1298},"end":{"line":91,"column":4,"offset":1340}}}],"position":{"start":{"line":89,"column":1,"offset":1298},"end":{"line":91,"column":4,"offset":1340}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Create a superuser user","position":{"start":{"line":93,"column":5,"offset":1346},"end":{"line":93,"column":28,"offset":1369}}}],"position":{"start":{"line":93,"column":1,"offset":1342},"end":{"line":93,"column":28,"offset":1369}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"create user mysuper with password '1234' SUPERUSER\n# or even better\ncreate user mysuper with password '1234' SUPERUSER CREATEDB CREATEROLE INHERIT LOGIN REPLICATION;\n# or\nsudo -u postgres createuser lemmy -W -s\n"}],"position":{"start":{"line":95,"column":1,"offset":1371},"end":{"line":101,"column":4,"offset":1591}}}],"position":{"start":{"line":95,"column":1,"offset":1371},"end":{"line":101,"column":4,"offset":1591}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Upgrade an existing user to superuser","position":{"start":{"line":103,"column":5,"offset":1597},"end":{"line":103,"column":42,"offset":1634}}}],"position":{"start":{"line":103,"column":1,"offset":1593},"end":{"line":103,"column":42,"offset":1634}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"alter user mysuper with superuser;\n# or even better\nalter user mysuper with SUPERUSER CREATEDB CREATEROLE INHERIT LOGIN REPLICATION\n"}],"position":{"start":{"line":105,"column":1,"offset":1636},"end":{"line":109,"column":4,"offset":1777}}}],"position":{"start":{"line":105,"column":1,"offset":1636},"end":{"line":109,"column":4,"offset":1777}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Show Database Version","position":{"start":{"line":111,"column":5,"offset":1783},"end":{"line":111,"column":26,"offset":1804}}}],"position":{"start":{"line":111,"column":1,"offset":1779},"end":{"line":111,"column":26,"offset":1804}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Change Database Owner","position":{"start":{"line":113,"column":5,"offset":1810},"end":{"line":113,"column":26,"offset":1831}}}],"position":{"start":{"line":113,"column":1,"offset":1806},"end":{"line":113,"column":26,"offset":1831}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"alter database database_name owner to new_owner;\n"}],"position":{"start":{"line":115,"column":1,"offset":1833},"end":{"line":117,"column":4,"offset":1891}}}],"position":{"start":{"line":115,"column":1,"offset":1833},"end":{"line":117,"column":4,"offset":1891}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Copy a database","position":{"start":{"line":119,"column":5,"offset":1897},"end":{"line":119,"column":20,"offset":1912}}}],"position":{"start":{"line":119,"column":1,"offset":1893},"end":{"line":119,"column":20,"offset":1912}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"CREATE DATABASE newdb WITH TEMPLATE originaldb;\n"}],"position":{"start":{"line":121,"column":1,"offset":1914},"end":{"line":123,"column":4,"offset":1971}}}],"position":{"start":{"line":121,"column":1,"offset":1914},"end":{"line":123,"column":4,"offset":1971}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"View Database Connections","position":{"start":{"line":125,"column":5,"offset":1977},"end":{"line":125,"column":30,"offset":2002}}}],"position":{"start":{"line":125,"column":1,"offset":1973},"end":{"line":125,"column":30,"offset":2002}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"SELECT * FROM pg_stat_activity;\n"}],"position":{"start":{"line":127,"column":1,"offset":2004},"end":{"line":129,"column":4,"offset":2045}}}],"position":{"start":{"line":127,"column":1,"offset":2004},"end":{"line":129,"column":4,"offset":2045}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"View show data directory (works on 9.1+)","position":{"start":{"line":131,"column":5,"offset":2051},"end":{"line":131,"column":45,"offset":2091}}}],"position":{"start":{"line":131,"column":1,"offset":2047},"end":{"line":131,"column":45,"offset":2091}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Show run-time parameters","position":{"start":{"line":133,"column":5,"offset":2097},"end":{"line":133,"column":29,"offset":2121}}}],"position":{"start":{"line":133,"column":1,"offset":2093},"end":{"line":133,"column":29,"offset":2121}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"show all;\nselect * from pg_settings;\n"}],"position":{"start":{"line":135,"column":1,"offset":2123},"end":{"line":138,"column":4,"offset":2169}}}],"position":{"start":{"line":135,"column":1,"offset":2123},"end":{"line":138,"column":4,"offset":2169}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Show the block size setting","position":{"start":{"line":140,"column":5,"offset":2175},"end":{"line":140,"column":32,"offset":2202}}}],"position":{"start":{"line":140,"column":1,"offset":2171},"end":{"line":140,"column":32,"offset":2202}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"# show block_size;\n block_size\n------------\n 8192\n(1 row)\n"}],"position":{"start":{"line":142,"column":1,"offset":2204},"end":{"line":148,"column":4,"offset":2271}}}],"position":{"start":{"line":142,"column":1,"offset":2204},"end":{"line":148,"column":4,"offset":2271}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Show stored procedure source","position":{"start":{"line":150,"column":5,"offset":2277},"end":{"line":150,"column":33,"offset":2305}}}],"position":{"start":{"line":150,"column":1,"offset":2273},"end":{"line":150,"column":33,"offset":2305}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"SELECT prosrc FROM pg_proc WHERE proname = 'procname'\n"}],"position":{"start":{"line":152,"column":1,"offset":2307},"end":{"line":154,"column":4,"offset":2370}}}],"position":{"start":{"line":152,"column":1,"offset":2307},"end":{"line":154,"column":4,"offset":2370}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Grant examples","position":{"start":{"line":156,"column":5,"offset":2376},"end":{"line":156,"column":19,"offset":2390}}}],"position":{"start":{"line":156,"column":1,"offset":2372},"end":{"line":156,"column":19,"offset":2390}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plpgsql"]},"children":[{"type":"text","value":"# readonly to all tables for myuser\ngrant select on all tables in schema public to myuser;\n# all privileges on table1 and table2 to myuser\ngrant all privileges on table1, table2, table3 to myuser;\n"}],"position":{"start":{"line":158,"column":1,"offset":2392},"end":{"line":163,"column":4,"offset":2603}}}],"position":{"start":{"line":158,"column":1,"offset":2392},"end":{"line":163,"column":4,"offset":2603}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Restore Postgres .dump file","position":{"start":{"line":165,"column":5,"offset":2609},"end":{"line":165,"column":32,"offset":2636}}}],"position":{"start":{"line":165,"column":1,"offset":2605},"end":{"line":165,"column":32,"offset":2636}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plpgsql"]},"children":[{"type":"text","value":"pg_restore --verbose --clean --no-acl --no-owner -h localhost -U myuser -d mydb latest.dump\n"}],"position":{"start":{"line":167,"column":1,"offset":2638},"end":{"line":169,"column":4,"offset":2744}}}],"position":{"start":{"line":167,"column":1,"offset":2638},"end":{"line":169,"column":4,"offset":2744}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://gist.github.com/kagemusha/1569836"},"children":[{"type":"text","value":"source","position":{"start":{"line":171,"column":2,"offset":2747},"end":{"line":171,"column":8,"offset":2753}}}],"position":{"start":{"line":171,"column":1,"offset":2746},"end":{"line":171,"column":52,"offset":2797}}}],"position":{"start":{"line":171,"column":1,"offset":2746},"end":{"line":171,"column":52,"offset":2797}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Find all active sessions and kill them (i.e. for when needing to drop or rename db)","position":{"start":{"line":173,"column":5,"offset":2803},"end":{"line":173,"column":88,"offset":2886}}}],"position":{"start":{"line":173,"column":1,"offset":2799},"end":{"line":173,"column":88,"offset":2886}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Source: ","position":{"start":{"line":175,"column":1,"offset":2888},"end":{"line":175,"column":9,"offset":2896}}},{"type":"element","tagName":"a","properties":{"href":"http://stackoverflow.com/questions/5408156/how-to-drop-a-postgresql-database-if-there-are-active-connections-to-it"},"children":[{"type":"text","value":"http://stackoverflow.com/questions/5408156/how-to-drop-a-postgresql-database-if-there-are-active-connections-to-it","position":{"start":{"line":175,"column":10,"offset":2897},"end":{"line":175,"column":124,"offset":3011}}}],"position":{"start":{"line":175,"column":9,"offset":2896},"end":{"line":175,"column":125,"offset":3012}}}],"position":{"start":{"line":175,"column":1,"offset":2888},"end":{"line":175,"column":125,"offset":3012}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plpgsql"]},"children":[{"type":"text","value":"# Postgres 9.6 and above\nSELECT pg_terminate_backend(pg_stat_activity.pid)\nFROM pg_stat_activity\nWHERE pg_stat_activity.datname = 'TARGET_DB'\n AND pid <> pg_backend_pid();\n\n# Postgres 9.6 and below\nSELECT pg_terminate_backend(pg_stat_activity.procpid)\nFROM pg_stat_activity\nWHERE pg_stat_activity.datname = 'TARGET_DB'\nAND procpid <> pg_backend_pid();\n"}],"position":{"start":{"line":177,"column":1,"offset":3014},"end":{"line":189,"column":4,"offset":3380}}}],"position":{"start":{"line":177,"column":1,"offset":3014},"end":{"line":189,"column":4,"offset":3380}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Handy Queries","position":{"start":{"line":191,"column":4,"offset":3385},"end":{"line":191,"column":17,"offset":3398}}}],"position":{"start":{"line":191,"column":1,"offset":3382},"end":{"line":191,"column":17,"offset":3398}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plpgsql"]},"children":[{"type":"text","value":"-- List procedure/function\nSELECT * FROM pg_proc WHERE proname='__procedurename__';\n\n-- List view (including the definition)\nSELECT * FROM pg_views WHERE viewname='__viewname__';\n\n-- Show DB table space in use\nSELECT pg_size_pretty(pg_total_relation_size('__table_name__'));:\n\n-- Show DB space in use\nSELECT pg_size_pretty(pg_database_size('__database_name__'));\n\n-- Show current user's statement timeout\nshow statement_timeout;\n\n-- Show table indexes\nSELECT * FROM pg_indexes WHERE tablename='__table_name__' AND schemaname='__schema_name__';\n\n-- Get all indexes from all tables of a schema:\nSELECT\n   t.relname AS table_name,\n   i.relname AS index_name,\n   a.attname AS column_name\nFROM\n   pg_class t,\n   pg_class i,\n   pg_index ix,\n   pg_attribute a,\n   pg_namespace n\nWHERE\n   t.oid = ix.indrelid\n   AND i.oid = ix.indexrelid\n   AND a.attrelid = t.oid\n   AND a.attnum = ANY(ix.indkey)\n   AND t.relnamespace = n.oid\n   AND n.nspname = 'kartones'\nORDER BY\n   t.relname,\n   i.relname\n\n-- Queries being executed at a certain DB\nSELECT datname, application_name, pid, backend_start, query_start, state_change, state, query\n  FROM pg_stat_activity\n  WHERE datname='__database_name__';\n\n-- Get all queries from all dbs waiting for data (might be hung)\nSELECT * FROM pg_stat_activity WHERE waiting='t';\n"}],"position":{"start":{"line":193,"column":1,"offset":3400},"end":{"line":241,"column":4,"offset":4713}}}],"position":{"start":{"line":193,"column":1,"offset":3400},"end":{"line":241,"column":4,"offset":4713}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Query analysis","position":{"start":{"line":243,"column":5,"offset":4719},"end":{"line":243,"column":19,"offset":4733}}}],"position":{"start":{"line":243,"column":1,"offset":4715},"end":{"line":243,"column":19,"offset":4733}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"-- See the query plan for the given query\nEXPLAIN __query__\n\n-- See and execute the query plan for the given query\nEXPLAIN ANALYZE __query__\n\n-- Collect statistics\nANALYZE [__table__]\n"}],"position":{"start":{"line":245,"column":1,"offset":4735},"end":{"line":254,"column":4,"offset":4928}}}],"position":{"start":{"line":245,"column":1,"offset":4735},"end":{"line":254,"column":4,"offset":4928}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Querying Data","position":{"start":{"line":256,"column":4,"offset":4933},"end":{"line":256,"column":17,"offset":4946}}}],"position":{"start":{"line":256,"column":1,"offset":4930},"end":{"line":256,"column":17,"offset":4946}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"From a Single Table","position":{"start":{"line":258,"column":5,"offset":4952},"end":{"line":258,"column":24,"offset":4971}}}],"position":{"start":{"line":258,"column":1,"offset":4948},"end":{"line":258,"column":24,"offset":4971}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"-- Query data in columns c1, c2 from a table\nSELECT c1, c2 FROM t;\n\n-- Query distinct rows from a table\nSELECT DISTINCT c1\nFROM t\nWHERE condition;\n\n-- Sort the result set in ascending or descending order\nSELECT c1, c2\nFROM t\nORDER BY c1 ASC [DESC];\n\n-- Skip offset of rows and return the next n rows\nSELECT c1, c2\nFROM t\nORDER BY c1\nLIMIT n\nOFFSET offset;\n\n-- Group rows using an aggregate function\nSELECT c1, aggregate(c2)\nFROM t\nGROUP BY c1;\n\n-- Filter groups using HAVING clause\nSELECT c1, aggregate(c2) FROM t\nGROUP BY c1\nHAVING condition;\n"}],"position":{"start":{"line":260,"column":1,"offset":4973},"end":{"line":290,"column":4,"offset":5526}}}],"position":{"start":{"line":260,"column":1,"offset":4973},"end":{"line":290,"column":4,"offset":5526}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"From Multiple Tables","position":{"start":{"line":292,"column":5,"offset":5532},"end":{"line":292,"column":25,"offset":5552}}}],"position":{"start":{"line":292,"column":1,"offset":5528},"end":{"line":292,"column":25,"offset":5552}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plpgsql"]},"children":[{"type":"text","value":"-- Inner join t1 and t2\nSELECT c1, c2\nFROM t1\nINNER JOIN t2\nON condition;\n\n-- Left join t1 and t1\nSELECT c1, c2\nFROM t1\nLEFT JOIN t2\nON condition;\n\n-- Right join t1 and t2\nSELECT c1, c2\nFROM t1\nRIGHT JOIN t2\nON condition;\n\n-- Perform full outer join\nSELECT c1, c2\nFROM t1\nFULL OUTER JOIN t2\nON condition;\n\n-- Produce a Cartesian product of rows in tables\nSELECT c1, c2\nFROM t1\nCROSS JOIN t2;\n\n-- Another way to perform cross join\nSELECT c1, c2\nFROM t1, t2;\n\n-- Join t1 to itself using INNER JOIN clause\nSELECT c1, c2\nFROM t1 A\nINNER JOIN t2 B ON condition\n"}],"position":{"start":{"line":294,"column":1,"offset":5554},"end":{"line":332,"column":4,"offset":6124}}}],"position":{"start":{"line":294,"column":1,"offset":5554},"end":{"line":332,"column":4,"offset":6124}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Using SQL Operators","position":{"start":{"line":334,"column":5,"offset":6130},"end":{"line":334,"column":24,"offset":6149}}}],"position":{"start":{"line":334,"column":1,"offset":6126},"end":{"line":334,"column":24,"offset":6149}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plpgsql"]},"children":[{"type":"text","value":"-- Combine rows from two queries\nSELECT c1, c2 FROM t1\nUNION [ALL]\nSELECT c1, c2 FROM t2;\n\n-- Return the intersection of two queries\nSELECT c1, c2 FROM t1\nINTERSECT\nSELECT c1, c2 FROM t2;\n\n-- Subtract a result set from another result set\nSELECT c1, c2 FROM t1\nEXCEPT\nSELECT c1, c2 FROM t2;\n\n-- Query rows using pattern matching %, _\nSELECT c1, c2 FROM t1\nWHERE c1 [NOT] LIKE pattern;\n\n-- Query rows in a list\nSELECT c1, c2\nFROM t\nWHERE c1\n[NOT] IN value_list;\n\n-- Query rows between two values\nSELECT c1, c2\nFROM t\nWHERE c1\nBETWEEN low AND high;\n\n-- Check if values in a table is NULL or not\nSELECT c1, c2 FROM t\nWHERE c1 IS [NOT] NULL;\n"}],"position":{"start":{"line":336,"column":1,"offset":6151},"end":{"line":371,"column":4,"offset":6802}}}],"position":{"start":{"line":336,"column":1,"offset":6151},"end":{"line":371,"column":4,"offset":6802}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Source","position":{"start":{"line":373,"column":4,"offset":6807},"end":{"line":373,"column":10,"offset":6813}}}],"position":{"start":{"line":373,"column":1,"offset":6804},"end":{"line":373,"column":10,"offset":6813}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.postgresql.org/docs/9.6/static/app-psql.html"},"children":[{"type":"text","value":"PostgreSQL 9.6.0 Documentation","position":{"start":{"line":375,"column":4,"offset":6818},"end":{"line":375,"column":34,"offset":6848}}}],"position":{"start":{"line":375,"column":3,"offset":6817},"end":{"line":375,"column":93,"offset":6907}}}],"position":{"start":{"line":375,"column":1,"offset":6815},"end":{"line":375,"column":93,"offset":6907}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://pgexercises.com"},"children":[{"type":"text","value":"PostgreSQL Exercises","position":{"start":{"line":376,"column":4,"offset":6911},"end":{"line":376,"column":24,"offset":6931}}}],"position":{"start":{"line":376,"column":3,"offset":6910},"end":{"line":376,"column":50,"offset":6957}}}],"position":{"start":{"line":376,"column":1,"offset":6908},"end":{"line":376,"column":50,"offset":6957}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"http://www.postgresqltutorial.com/postgresql-cheat-sheets"},"children":[{"type":"text","value":"PostgreSQL Tutorial","position":{"start":{"line":377,"column":4,"offset":6961},"end":{"line":377,"column":23,"offset":6980}}}],"position":{"start":{"line":377,"column":3,"offset":6960},"end":{"line":377,"column":83,"offset":7040}}}],"position":{"start":{"line":377,"column":1,"offset":6958},"end":{"line":377,"column":83,"offset":7040}}},{"type":"text","value":"\n"}],"position":{"start":{"line":375,"column":1,"offset":6815},"end":{"line":377,"column":83,"offset":7040}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":378,"column":1,"offset":7041}}}}